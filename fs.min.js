// (c) 2011 Enginimation Studio (http://enginimation.com).
// fs.js may be freely distributed under the MIT license.
"use strict";var global=this,requestFileSystem=global.requestFileSystem||global.webkitRequestFileSystem,BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder,resolveLocalFileSystemURL=global.resolveLocalFileSystemURL||global.webkitResolveLocalFileSystemURL,fsURL=global.URL||global.webkitURL,fs=Object.create({},{version:{value:"0.8.7"},log:{value:!1,writable:!0},maxSize:{value:5347737600,writable:!0},FILE_EXPECTED:{value:6},BROWSER_NOT_SUPPORTED:{value:7},getNativeFS:{value:function(a,b){if(requestFileSystem){var c=global.PERSISTENT;b&&b.tmp&&(c=global.TEMPORARY),requestFileSystem(c,this.maxSize,function(b){a(undefined,b)},function(b){a(b)})}else a(fs.BROWSER_NOT_SUPPORTED)}},createBlob:{value:function(a,b){var c=new BlobBuilder;c.append(a);return c.getBlob(b)}},base64StringToBlob:{value:function(a,b){var c=atob(a),d=c.length,e=new Int8Array(d);for(var f=0;f<d;f++)e[f]=c.charCodeAt(f);return this.createBlob(e.buffer,b)}}});"use strict",Object.defineProperty(File.prototype,"shortName",{value:function(){var a=this.name.lastIndexOf(".");return this.name.substring(0,a)}}),Object.defineProperty(File.prototype,"extension",{value:function(){var a=this.name.lastIndexOf(".");return this.name.substring(a)}}),Object.defineProperty(File.prototype,"sizeInKB",{value:function(){var a=this.size;return(a/1014).toFixed(1)}}),Object.defineProperty(File.prototype,"sizeInMB",{value:function(){var a=this.size;return(a/1038336).toFixed(1)}}),Object.defineProperty(File.prototype,"sizeInGB",{value:function(){var a=this.size;return(a/1063256064).toFixed(1)}}),Object.defineProperty(FileError.prototype,"message",{value:function(){var a="";switch(this.code){case FileError.QUOTA_EXCEEDED_ERR:a="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:a="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:a="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:a="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:a="INVALID_STATE_ERR";break;case fs.FILE_EXPECTED:a="FILE_EXPECTED";break;case fs.BROWSER_NOT_SUPPORTED:a="BROWSER_NOT_SUPPORTED";break;default:a="Unknown Error"}return a}}),"use strict",fs.io=Object.create({},{createFile:{value:function(a,b){fs.util.getFileFromRoot(a,b,{})}},createTmpFile:{value:function(a,b){fs.util.getFileFromRoot(a,b,{tmp:!0})}},createDirectory:{value:function(a,b){fs.util.getDirectoryFromRoot(a,b,{})}},createTmpDirectory:{value:function(a,b){fs.util.getDirectoryFromRoot(a,b,{tmp:!0})}},readDirectory:{value:function(a,b){fs.util.getDirectory(a,function(a,c){a?b(a):fs.util.readEntriesFromDirectory(c,b)},{})}},readRootDirectory:{value:function(a){fs.getNativeFS(function(b,c){b?a(b):fs.util.readEntriesFromDirectory(c.root,a)},{})}}}),"use strict";var global=this;fs.util=Object.create({},{getReader:{value:function(a,b,c){var d=new FileReader,e=a;d.onloadend=function(a){b(undefined,this.result,e)},d[c](e)}},getFile:{value:function(a,b,c){a.getFile(b,{create:!0},function(a){c(undefined,a)},function(a){c(a)})}},getDirectory:{value:function(a,b,c){c(undefined,a.getDirectory(b,{create:!0}))}},getDirectoryFromRoot:{value:function(a,b,c){fs.getNativeFS(function(c,d){c?b(c):fs.util.getDirectory(d.root,a,b)},c)}},readEntriesFromDirectory:{value:function(a,b){var c=a.createReader();c.readEntries(function(a){b(undefined,a)},function(a){b(a)})}},readAsArrayBuffer:{value:function(a,b,c){this.getReaderUsingFileName(a,b,"readAsArrayBuffer",c)}},readFileAsArrayBuffer:{value:function(a,b){this.getReader(a,b,"readAsArrayBuffer")}},readAsBinaryString:{value:function(a,b,c){this.getReaderUsingFileName(a,b,"readAsBinaryString",c)}},readFileAsBinaryString:{value:function(a,b){this.getReader(a,b,"readAsBinaryString")}},readAsDataUrl:{value:function(a,b,c){this.getReaderUsingFileName(a,b,"readAsDataURL",c)}},readAsText:{value:function(a,b,c){this.getReaderUsingFileName(a,b,"readAsText",c)}},writeBase64StrToFile:{value:function(a,b,c,d,e){var f=fs.base64StringToBlob(b,c);this.writeBlobToFile(a,f,d,e)}},writeBlobToFile:{value:function(a,b,c,d){this.getFileFromRoot(a,function(a,d){a?c(a):d.createWriter(function(a){a.onwriteend=function(a){c(undefined)},a.onerror=function(a){c(a)},a.write(b)},function(a){c(a)})},d)}},writeTextToFile:{value:function(a,b,c,d){var e=fs.createBlob(b,"text/plain");fs.util.writeBlobToFile(a,e,c,d)}},writeArrayBufferToFile:{value:function(a,b,c,d,e){var f=fs.createBlob(c,b);fs.util.writeBlobToFile(a,f,d,e)}},writeFileToFile:{value:function(a,b,c){this.readFileAsArrayBuffer(a,function(d,e,f){if(d)b(d);else{var g=c.filename||f.name;fs.util.writeArrayBufferToFile(g,a.type,e,b,c)}})}},getReaderUsingFileName:{value:function(a,b,c,d){fs.getNativeFS(function(d,e){d?b(d):e.root.getFile(a,{},function(a){a.isFile===!0?a.file(function(a){fs.util.getReader(a,b,c)},function(a){b(a)}):b(fs.FILE_EXPECTED)},function(a){b(a)})},d)}},getFileFromRoot:{value:function(a,b,c){fs.getNativeFS(function(c,d){c?b(c):fs.util.getFile(d.root,a,b)},c)}},createFileURL:{value:function(a,b){fs.util.getFileFromRoot(a,function(a,c){c.file(function(a){var c=fsURL.createObjectURL(a);b(c)})})}},destroyFileURL:{value:function(a){fsURL.revokeObjectURL(a)}},remove:{value:function(a,b){this.getFileFromRoot(a,function(a,c){c.remove(function(){b(undefined)},function(a){b(a)})})}}}),"use strict",fs.read=Object.create({},{asDataUrl:{value:function(a,b){fs.util.readAsDataUrl(a,b,{})}},tmpFileAsDataUrl:{value:function(a,b){fs.util.readAsDataUrl(a,b,{tmp:!0})}},asText:{value:function(a,b){fs.util.readAsText(a,b,{})}},tmpFileAsText:{value:function(a,b){fs.util.readAsText(a,b,{tmp:!0})}},asBinaryString:{value:function(a,b){fs.util.readAsBinaryString(a,b,{})}},tmpFileAsBinaryString:{value:function(a,b){fs.util.readAsBinaryString(a,b,{tmp:!0})}},asArrayBuffer:{value:function(a,b){fs.util.readAsArrayBuffer(a,b,{})}},tmpFileAsArrayBuffer:{value:function(a,b){fs.util.readAsArrayBuffer(a,b,{tmp:!0})}},fileAsText:{value:function(a,b){fs.util.getReader(a,b,"readAsText")}},fileAsDataURL:{value:function(a,b){fs.util.getReader(a,b,"readAsDataURL")}},fileAsArrayBuffer:{value:function(a,b){fs.util.readFileAsArrayBuffer(a,b)}},fileAsBinaryString:{value:function(a,b){fs.util.readFileAsBinaryString(a,b)}}}),"use strict",fs.write=Object.create({},{file:{value:function(a,b,c){fs.util.writeFileToFile(a,b,{filename:c})}},fileToTmpFile:{value:function(a,b,c){fs.util.writeFileToFile(a,b,{tmp:!0})}},blob:{value:function(a,b,c){fs.util.writeBlobToFile(a,b,c,{})}},blobToTmpFile:{value:function(a,b,c){fs.util.writeBlobToFile(a,b,c,{tmp:!0})}},text:{value:function(a,b,c){fs.util.writeTextToFile(a,b,c,{})}},textToTmpFile:{value:function(a,b,c){fs.util.writeTextToFile(a,b,c,{tmp:!0})}},base64Str:{value:function(a,b,c,d){fs.util.writeBase64StrToFile(a,b,c,d,{})}},base64StrToTmpFile:{value:function(a,b,c,d){fs.util.writeBase64StrToFile(a,b,c,d,{tmp:!0})}}})